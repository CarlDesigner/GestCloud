---
// Componente de modal de confirmación para eliminar - Reutilizable
const { id = 'modal-eliminar' } = Astro.props;
---

<!-- Modal de confirmación para eliminar -->
<div id={id} tabindex="-1" class="fixed inset-0 z-50 items-center justify-center bg-black/50 hidden">
	<div class="relative w-full max-w-md mx-auto p-4">
		<div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
			<button type="button" id="cerrar-modal-eliminar" class="absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ml-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white">
				<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x w-3 h-3"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
			</button>
			<div class="p-6 text-center">
				<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-alert-circle mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200"><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>
				<h3 id="mensaje-eliminar" class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">¿Estás seguro de que quieres eliminar este registro?</h3>
				<button id="confirmar-eliminar" type="button" class="text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2">
					Sí, eliminar
				</button>
				<button id="cancelar-eliminar" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">No, cancelar</button>
			</div>
		</div>
	</div>
</div>

<script>
	// @ts-nocheck
	// Funciones globales para el modal de eliminación
	let pendingDeleteCallback = null;

	// Función para mostrar el modal de eliminación
	window.mostrarModalEliminar = function mostrarModalEliminar(mensaje, callback) {
		const modal = document.getElementById('modal-eliminar');
		const mensajeElement = document.getElementById('mensaje-eliminar');
		
		if (!modal) return;
		
		// Personalizar mensaje
		if (mensajeElement && mensaje) {
			mensajeElement.textContent = mensaje;
		}
		
		// Guardar callback
		pendingDeleteCallback = callback;
		
		// Mostrar modal
		modal.classList.remove('hidden');
		modal.classList.add('flex');
	};

	// Función para cerrar el modal
	window.cerrarModalEliminar = function cerrarModalEliminar() {
		const modal = document.getElementById('modal-eliminar');
		if (modal) {
			modal.classList.add('hidden');
			modal.classList.remove('flex');
		}
		pendingDeleteCallback = null;
	};

	// Función para confirmar eliminación
	window.confirmarEliminacion = function confirmarEliminacion() {
		if (pendingDeleteCallback && typeof pendingDeleteCallback === 'function') {
			pendingDeleteCallback();
		}
		window.cerrarModalEliminar();
	};

	// Event listeners para los botones
	document.addEventListener('DOMContentLoaded', () => {
		const confirmarBtn = document.getElementById('confirmar-eliminar');
		const cancelarBtn = document.getElementById('cancelar-eliminar');
		const cerrarBtn = document.getElementById('cerrar-modal-eliminar');

		if (confirmarBtn) {
			confirmarBtn.addEventListener('click', window.confirmarEliminacion);
		}

		if (cancelarBtn) {
			cancelarBtn.addEventListener('click', window.cerrarModalEliminar);
		}

		if (cerrarBtn) {
			cerrarBtn.addEventListener('click', window.cerrarModalEliminar);
		}

		// Cerrar con ESC
		document.addEventListener('keydown', (e) => {
			if (e.key === 'Escape') {
				const modal = document.getElementById('modal-eliminar');
				if (modal && !modal.classList.contains('hidden')) {
					window.cerrarModalEliminar();
				}
			}
		});

		// Cerrar al hacer clic fuera del modal
		const modal = document.getElementById('modal-eliminar');
		if (modal) {
			modal.addEventListener('click', (e) => {
				if (e.target === modal) {
					window.cerrarModalEliminar();
				}
			});
		}
	});
</script>
